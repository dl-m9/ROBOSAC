Namespace(adv_iter=15, adv_method='cw-l2', apply_late_fusion=0, batch=1, bound='both', box_com=False, box_matching_thresh=0.3, com='mean', compress_level=0, data='/data2/user2/senkang/CP-GuardBench/V2X-Sim-det/test_28/', ego_agent=3, ego_loss_only=False, eps=0.25, fix_attackers=False, gnn_iter_times=3, inference=None, kd_flag=0, kd_weight=100000, layer=3, log=True, logpath='', lr=0.001, nepoch=100, no_cross_road=False, num_agent=6, number_of_attackers=2, nworker=4, only_v2i=0, partial_upperbound=False, pert_alpha=0.1, pose_noise=0, random_attack=False, resume='/data2/user2/senkang/CP-GuardBench/coperception/ckpt/meanfusion/epoch_49.pth', resume_teacher='', robosac='cp-guard', robosac_k=None, sample_id=None, scene_id=[28], step_budget=3, tracking=False, use_history_frame=False, visualization=False, warp_flag=False)
device number 1
flag mean
The number of val sequences: 100
/home/user2/miniconda3/envs/coperception/lib/python3.7/site-packages/mmcv/__init__.py:21: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  'On January 1, 2023, MMCV will release v2.0.0, in which it will remove '
The number of val sequences: 100
robosac.py:168: RuntimeWarning: divide by zero encountered in log
  N = np.ceil(np.log(1 - 0.99) / np.log(1 - np.power(1 - eta, num_consensus))).astype(int)
Validation dataset size: 100
Load model from /data2/user2/senkang/CP-GuardBench/coperception/ckpt/meanfusion/epoch_49.pth, at epoch 49
  0%|          | 0/100 [00:00<?, ?it/s]/home/user2/miniconda3/envs/coperception/lib/python3.7/site-packages/torch/nn/functional.py:3888: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  "Default grid_sample and affine_grid behavior has changed "
/home/user2/miniconda3/envs/coperception/lib/python3.7/site-packages/torch/nn/functional.py:3826: UserWarning: Default grid_sample and affine_grid behavior has changed to align_corners=False since 1.3.0. Please specify align_corners=True if the old behavior is desired. See the documentation of grid_sample for details.
  "Default grid_sample and affine_grid behavior has changed "
  1%|          | 1/100 [01:49<3:00:52, 109.62s/it]  2%|▏         | 2/100 [03:17<2:38:18, 96.93s/it]   3%|▎         | 3/100 [04:45<2:29:52, 92.71s/it]  4%|▍         | 4/100 [06:31<2:36:45, 97.97s/it]  5%|▌         | 5/100 [07:58<2:28:58, 94.08s/it]  6%|▌         | 6/100 [09:25<2:23:48, 91.80s/it]  7%|▋         | 7/100 [10:47<2:16:53, 88.32s/it]  8%|▊         | 8/100 [12:37<2:26:03, 95.25s/it]  9%|▉         | 9/100 [14:06<2:21:28, 93.29s/it] 10%|█         | 10/100 [16:05<2:31:51, 101.24s/it] 11%|█         | 11/100 [18:07<2:39:38, 107.63s/it] 12%|█▏        | 12/100 [19:38<2:30:24, 102.55s/it] 13%|█▎        | 13/100 [21:22<2:29:23, 103.03s/it] 14%|█▍        | 14/100 [22:54<2:22:57, 99.74s/it]  15%|█▌        | 15/100 [24:41<2:24:22, 101.91s/it] 16%|█▌        | 16/100 [26:45<2:32:08, 108.67s/it] 17%|█▋        | 17/100 [28:38<2:32:11, 110.02s/it] 18%|█▊        | 18/100 [30:34<2:32:28, 111.57s/it] 19%|█▉        | 19/100 [32:29<2:32:17, 112.81s/it] 20%|██        | 20/100 [34:37<2:36:13, 117.16s/it] 21%|██        | 21/100 [36:14<2:26:32, 111.30s/it] 22%|██▏       | 22/100 [37:56<2:21:01, 108.48s/it] 23%|██▎       | 23/100 [39:33<2:14:45, 105.01s/it] 24%|██▍       | 24/100 [41:23<2:14:59, 106.57s/it] 25%|██▌       | 25/100 [43:03<2:10:31, 104.42s/it] 26%|██▌       | 26/100 [44:58<2:12:41, 107.59s/it] 27%|██▋       | 27/100 [47:05<2:17:59, 113.42s/it] 28%|██▊       | 28/100 [48:56<2:15:15, 112.71s/it] 29%|██▉       | 29/100 [51:06<2:19:28, 117.87s/it] 30%|███       | 30/100 [52:47<2:11:34, 112.78s/it] 31%|███       | 31/100 [54:45<2:11:36, 114.45s/it] 32%|███▏      | 32/100 [56:24<2:04:22, 109.74s/it] 33%|███▎      | 33/100 [58:27<2:06:54, 113.66s/it] 34%|███▍      | 34/100 [1:00:31<2:08:30, 116.83s/it] 35%|███▌      | 35/100 [1:02:39<2:10:25, 120.39s/it] 36%|███▌      | 36/100 [1:04:47<2:10:33, 122.40s/it] 37%|███▋      | 37/100 [1:06:26<2:01:26, 115.67s/it] 38%|███▊      | 38/100 [1:08:14<1:56:56, 113.17s/it]
Scene 28, Frame 0:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999995231628418
selected:  12
selected:  7
selected:  12
selected:  7

Scene 28, Frame 1:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999911785125732
selected:  10
selected:  7
selected:  12
selected:  7

Scene 28, Frame 2:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999852180480957
selected:  11
selected:  7
selected:  12
selected:  8

Scene 28, Frame 3:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9999630451202393
selected:  11
selected:  7
selected:  12
selected:  106

Scene 28, Frame 4:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999934434890747
selected:  12
selected:  8
selected:  12
selected:  7

Scene 28, Frame 5:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999935626983643
selected:  11
selected:  8
selected:  11
selected:  7

Scene 28, Frame 6:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999972581863403
selected:  10
selected:  7
selected:  12
selected:  8

Scene 28, Frame 7:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  10
selected:  8
selected:  11
selected:  99

Scene 28, Frame 8:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999799728393555
selected:  11
selected:  7
selected:  13
selected:  7

Scene 28, Frame 9:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  10
selected:  7
selected:  12
selected:  94

Scene 28, Frame 10:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 1 is adversarial 0.7842572331428528
Agent 3 is adversarial 0.9999792575836182
selected:  9
selected:  9
selected:  12
selected:  108

Scene 28, Frame 11:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999954700469971
selected:  11
selected:  8
selected:  12
selected:  9

Scene 28, Frame 12:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9999953508377075
selected:  12
selected:  7
selected:  12
selected:  99

Scene 28, Frame 13:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 0.9785501956939697
Agent 1 is adversarial 0.6746729016304016
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999998807907104
selected:  13
selected:  7
selected:  8
selected:  10

Scene 28, Frame 14:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 1 is adversarial 0.9030470252037048
Agent 3 is adversarial 0.9999949932098389
selected:  11
selected:  8
selected:  10
selected:  90

Scene 28, Frame 15:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999995231628418
selected:  12
selected:  10
selected:  12
selected:  89

Scene 28, Frame 16:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999953508377075
selected:  11
selected:  10
selected:  12
selected:  94

Scene 28, Frame 17:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9999974966049194
selected:  12
selected:  9
selected:  12
selected:  85

Scene 28, Frame 18:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 0.9999948740005493
Agent 3 is adversarial 0.9999135732650757
selected:  10
selected:  7
selected:  12
selected:  10

Scene 28, Frame 19:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  12
selected:  8
selected:  12
selected:  78

Scene 28, Frame 20:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 1 is adversarial 0.8238899111747742
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999662637710571
selected:  12
selected:  7
selected:  11
selected:  2

Scene 28, Frame 21:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 0.9999957084655762
Agent 3 is adversarial 0.9999959468841553
selected:  11
selected:  8
selected:  12
selected:  10

Scene 28, Frame 22:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 1 is adversarial 0.9194000363349915
Agent 2 is adversarial 1.0
selected:  10
selected:  7
selected:  12
selected:  53

Scene 28, Frame 23:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999994039535522
selected:  13
selected:  8
selected:  12
selected:  7

Scene 28, Frame 24:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 1 is adversarial 0.9998984336853027
Agent 2 is adversarial 0.9999997615814209
Agent 3 is adversarial 0.9999996423721313
selected:  9
selected:  8
selected:  12
selected:  3

Scene 28, Frame 25:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 1 is adversarial 0.5631228685379028
Agent 2 is adversarial 1.0
selected:  10
selected:  8
selected:  11
selected:  50

Scene 28, Frame 26:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 1.0
selected:  9
selected:  7
selected:  11
selected:  89

Scene 28, Frame 27:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 3 is adversarial 0.6767072677612305
Agent 2 is adversarial 1.0
Agent 3 is adversarial 1.0
selected:  12
selected:  9
selected:  12
selected:  10

Scene 28, Frame 28:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 3 is adversarial 0.974180281162262
Agent 2 is adversarial 1.0
selected:  11
selected:  9
selected:  13
selected:  78

Scene 28, Frame 29:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 1.0
selected:  11
selected:  7
selected:  12
selected:  10

Scene 28, Frame 30:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 2 is adversarial 0.5358995795249939
Agent 3 is adversarial 0.992510199546814
Agent 3 is adversarial 1.0
selected:  9
selected:  6
selected:  9
selected:  73

Scene 28, Frame 31:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 3 is adversarial 0.9968262910842896
Agent 2 is adversarial 1.0
Agent 3 is adversarial 1.0
selected:  10
selected:  8
selected:  10
selected:  5

Scene 28, Frame 32:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 0.7888713479042053
Agent 3 is adversarial 0.968985915184021
Agent 2 is adversarial 1.0
selected:  13
selected:  6
selected:  13
selected:  77

Scene 28, Frame 33:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 3 is adversarial 0.9550792574882507
Agent 2 is adversarial 1.0
selected:  13
selected:  8
selected:  11
selected:  72

Scene 28, Frame 34:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 2 is adversarial 0.9988476037979126
Agent 3 is adversarial 0.8927748203277588
Agent 3 is adversarial 1.0
selected:  14
selected:  6
selected:  10
selected:  82

Scene 28, Frame 35:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 2 is adversarial 0.9983988404273987
Agent 3 is adversarial 0.9303803443908691
Agent 3 is adversarial 1.0
selected:  11
selected:  6
selected:  10
selected:  83

Scene 28, Frame 36:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 3 is adversarial 0.673569917678833
Agent 2 is adversarial 1.0
Agent 3 is adversarial 1.0
selected:  12
selected:  8
selected:  11
selected:  9

Scene 28, Frame 37:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 1.0
selected:  12
selected:  9
selected:  11
selected:  7

Scene 28, Frame 38:
all_agent_list: [0, 1, 2] 39%|███▉      | 39/100 [1:09:58<1:52:09, 110.32s/it] 40%|████      | 40/100 [1:11:37<1:47:09, 107.16s/it] 41%|████      | 41/100 [1:13:18<1:43:19, 105.08s/it] 42%|████▏     | 42/100 [1:15:02<1:41:22, 104.87s/it] 43%|████▎     | 43/100 [1:16:54<1:41:40, 107.02s/it] 44%|████▍     | 44/100 [1:18:43<1:40:22, 107.54s/it] 45%|████▌     | 45/100 [1:20:22<1:36:23, 105.15s/it] 46%|████▌     | 46/100 [1:22:08<1:34:55, 105.47s/it] 47%|████▋     | 47/100 [1:23:49<1:31:56, 104.09s/it] 48%|████▊     | 48/100 [1:25:35<1:30:41, 104.64s/it] 49%|████▉     | 49/100 [1:27:29<1:31:13, 107.33s/it] 50%|█████     | 50/100 [1:29:11<1:28:08, 105.76s/it] 51%|█████     | 51/100 [1:30:49<1:24:32, 103.51s/it] 52%|█████▏    | 52/100 [1:32:35<1:23:21, 104.21s/it] 53%|█████▎    | 53/100 [1:34:21<1:22:09, 104.87s/it] 54%|█████▍    | 54/100 [1:36:14<1:22:09, 107.17s/it] 55%|█████▌    | 55/100 [1:38:08<1:21:55, 109.24s/it] 56%|█████▌    | 56/100 [1:39:58<1:20:21, 109.57s/it] 57%|█████▋    | 57/100 [1:41:44<1:17:45, 108.50s/it] 58%|█████▊    | 58/100 [1:43:32<1:15:40, 108.11s/it] 59%|█████▉    | 59/100 [1:45:20<1:13:55, 108.19s/it] 60%|██████    | 60/100 [1:46:56<1:09:39, 104.48s/it] 61%|██████    | 61/100 [1:48:27<1:05:14, 100.36s/it] 62%|██████▏   | 62/100 [1:50:05<1:03:11, 99.76s/it]  63%|██████▎   | 63/100 [1:51:31<58:58, 95.65s/it]   64%|██████▍   | 64/100 [1:53:05<57:01, 95.03s/it] 65%|██████▌   | 65/100 [1:54:38<55:08, 94.53s/it] 66%|██████▌   | 66/100 [1:56:04<52:04, 91.90s/it] 67%|██████▋   | 67/100 [1:57:39<51:03, 92.83s/it] 68%|██████▊   | 68/100 [1:59:20<50:47, 95.24s/it] 69%|██████▉   | 69/100 [2:00:56<49:27, 95.72s/it] 70%|███████   | 70/100 [2:02:30<47:30, 95.03s/it] 71%|███████   | 71/100 [2:04:12<46:58, 97.18s/it] 72%|███████▏  | 72/100 [2:05:39<43:56, 94.18s/it] 73%|███████▎  | 73/100 [2:07:20<43:18, 96.26s/it] 74%|███████▍  | 74/100 [2:08:55<41:32, 95.86s/it] 75%|███████▌  | 75/100 [2:10:22<38:51, 93.26s/it] 76%|███████▌  | 76/100 [2:11:50<36:40, 91.70s/it] 77%|███████▋  | 77/100 [2:13:15<34:19, 89.54s/it] 78%|███████▊  | 78/100 [2:14:50<33:23, 91.05s/it] 79%|███████▉  | 79/100 [2:16:24<32:12, 92.03s/it]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999998807907104
selected:  11
selected:  7
selected:  11
selected:  60

Scene 28, Frame 39:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 3 is adversarial 0.5271764397621155
Agent 2 is adversarial 1.0
Agent 3 is adversarial 1.0
selected:  10
selected:  7
selected:  11
selected:  5

Scene 28, Frame 40:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999998807907104
selected:  13
selected:  11
selected:  12
selected:  8

Scene 28, Frame 41:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  13
selected:  8
selected:  10
selected:  58

Scene 28, Frame 42:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  12
selected:  9
selected:  11
selected:  51

Scene 28, Frame 43:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  12
selected:  7
selected:  10
selected:  48

Scene 28, Frame 44:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999998807907104
selected:  12
selected:  8
selected:  11
selected:  61

Scene 28, Frame 45:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9999997615814209
selected:  12
selected:  9
selected:  11
selected:  55

Scene 28, Frame 46:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 3 is adversarial 0.9999994039535522
Agent 2 is adversarial 0.9999892711639404
selected:  14
selected:  8
selected:  11
selected:  50

Scene 28, Frame 47:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 3 is adversarial 0.9998383522033691
Agent 1 is adversarial 0.781693160533905
Agent 2 is adversarial 0.9999996423721313
selected:  14
selected:  9
selected:  10
selected:  56

Scene 28, Frame 48:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9961062073707581
Agent 3 is adversarial 0.9999995231628418
selected:  10
selected:  8
selected:  11
selected:  60

Scene 28, Frame 49:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 3 is adversarial 0.9409818053245544
Agent 2 is adversarial 0.9999654293060303
selected:  11
selected:  8
selected:  11
selected:  47

Scene 28, Frame 50:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 0.9143591523170471
Agent 2 is adversarial 0.9999741315841675
Agent 3 is adversarial 0.9999985694885254
selected:  10
selected:  8
selected:  11
selected:  9

Scene 28, Frame 51:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 0.6372360587120056
Agent 2 is adversarial 1.0
selected:  11
selected:  8
selected:  12
selected:  52

Scene 28, Frame 52:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999991655349731
selected:  11
selected:  10
selected:  12
selected:  11

Scene 28, Frame 53:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 3 is adversarial 0.9999988079071045
Agent 2 is adversarial 1.0
selected:  11
selected:  10
selected:  11
selected:  52

Scene 28, Frame 54:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.8045730590820312
Agent 3 is adversarial 0.9999945163726807
selected:  11
selected:  9
selected:  10
selected:  73

Scene 28, Frame 55:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.6603738069534302
Agent 3 is adversarial 0.9999672174453735
selected:  11
selected:  9
selected:  11
selected:  59

Scene 28, Frame 56:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.7694515585899353
Agent 3 is adversarial 0.9999827146530151
selected:  12
selected:  9
selected:  11
selected:  60

Scene 28, Frame 57:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999537467956543
selected:  9
selected:  9
selected:  10
selected:  57

Scene 28, Frame 58:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9999711513519287
selected:  13
selected:  9
selected:  11
selected:  58

Scene 28, Frame 59:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999550580978394
selected:  12
selected:  9
selected:  11
selected:  62

Scene 28, Frame 60:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  11
selected:  10
selected:  12
selected:  51

Scene 28, Frame 61:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 0.9997634291648865
selected:  11
selected:  11
selected:  12
selected:  53

Scene 28, Frame 62:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 0.9999998807907104
Agent 3 is adversarial 0.9999356269836426
selected:  12
selected:  10
selected:  12
selected:  10

Scene 28, Frame 63:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  12
selected:  9
selected:  12
selected:  54

Scene 28, Frame 64:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999488592147827
selected:  12
selected:  9
selected:  10
selected:  8

Scene 28, Frame 65:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9997624754905701
selected:  11
selected:  9
selected:  11
selected:  9

Scene 28, Frame 66:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 0.9999971389770508
selected:  10
selected:  9
selected:  11
selected:  53

Scene 28, Frame 67:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 0.9999997615814209
selected:  11
selected:  9
selected:  12
selected:  47

Scene 28, Frame 68:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  11
selected:  9
selected:  10
selected:  58

Scene 28, Frame 69:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  10
selected:  10
selected:  10
selected:  50

Scene 28, Frame 70:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9996815919876099
selected:  11
selected:  9
selected:  10
selected:  62

Scene 28, Frame 71:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9998255372047424
selected:  10
selected:  10
selected:  11
selected:  10

Scene 28, Frame 72:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  11
selected:  9
selected:  9
selected:  59

Scene 28, Frame 73:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  11
selected:  10
selected:  10
selected:  54

Scene 28, Frame 74:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999616146087646
selected:  11
selected:  10
selected:  9
selected:  10

Scene 28, Frame 75:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999936819076538
selected:  11
selected:  9
selected:  11
selected:  10

Scene 28, Frame 76:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999375343322754
selected:  11
selected:  8
selected:  10
selected:  8

Scene 28, Frame 77:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  9
selected:  9
selected:  9
selected:  56

Scene 28, Frame 78:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9998430013656616
selected:  10
selected:  9
selected:  10
selected:  8

Scene 28, Frame 79:
all_agent_list: 80%|████████  | 80/100 [2:18:05<31:36, 94.80s/it] 81%|████████  | 81/100 [2:19:43<30:19, 95.74s/it] 82%|████████▏ | 82/100 [2:21:17<28:31, 95.06s/it] 83%|████████▎ | 83/100 [2:22:47<26:31, 93.64s/it] 84%|████████▍ | 84/100 [2:24:24<25:12, 94.56s/it] 85%|████████▌ | 85/100 [2:26:16<24:57, 99.80s/it] 86%|████████▌ | 86/100 [2:28:05<23:56, 102.63s/it] 87%|████████▋ | 87/100 [2:29:58<22:56, 105.87s/it] 88%|████████▊ | 88/100 [2:31:42<21:03, 105.29s/it] 89%|████████▉ | 89/100 [2:33:28<19:19, 105.39s/it] 90%|█████████ | 90/100 [2:35:03<17:04, 102.42s/it] 91%|█████████ | 91/100 [2:36:48<15:26, 102.97s/it] 92%|█████████▏| 92/100 [2:38:35<13:55, 104.41s/it] 93%|█████████▎| 93/100 [2:40:19<12:09, 104.15s/it] 94%|█████████▍| 94/100 [2:41:53<10:06, 101.06s/it] 95%|█████████▌| 95/100 [2:43:22<08:07, 97.47s/it]  96%|█████████▌| 96/100 [2:44:36<06:01, 90.49s/it] 97%|█████████▋| 97/100 [2:45:48<04:14, 84.88s/it] 98%|█████████▊| 98/100 [2:47:07<02:46, 83.31s/it] 99%|█████████▉| 99/100 [2:48:23<01:20, 80.97s/it]100%|██████████| 100/100 [2:49:29<00:00, 76.49s/it]100%|██████████| 100/100 [2:49:29<00:00, 101.70s/it] [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9999853372573853
selected:  11
selected:  10
selected:  11
selected:  63

Scene 28, Frame 80:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9998992681503296
selected:  10
selected:  12
selected:  10
selected:  58

Scene 28, Frame 81:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999816417694092
selected:  10
selected:  9
selected:  11
selected:  51

Scene 28, Frame 82:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.9998010993003845
selected:  11
selected:  9
selected:  12
selected:  51

Scene 28, Frame 83:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  11
selected:  9
selected:  10
selected:  53

Scene 28, Frame 84:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.999968409538269
selected:  11
selected:  8
selected:  10
selected:  61

Scene 28, Frame 85:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 3 is adversarial 0.5585833191871643
Agent 2 is adversarial 1.0
selected:  11
selected:  8
selected:  13
selected:  49

Scene 28, Frame 86:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  11
selected:  8
selected:  11
selected:  52

Scene 28, Frame 87:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.999870777130127
selected:  10
selected:  9
selected:  9
selected:  58

Scene 28, Frame 88:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 1]
Agent 3 is adversarial 0.999927282333374
selected:  11
selected:  8
selected:  10
selected:  64

Scene 28, Frame 89:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 0]
Agent 2 is adversarial 1.0
Agent 3 is adversarial 0.9999316930770874
selected:  10
selected:  8
selected:  9
selected:  7

Scene 28, Frame 90:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  8
selected:  10
selected:  10
selected:  52

Scene 28, Frame 91:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999942779541016
selected:  11
selected:  8
selected:  11
selected:  61

Scene 28, Frame 92:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  11
selected:  11
selected:  12
selected:  56

Scene 28, Frame 93:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 2 is adversarial 0.9999988079071045
Agent 3 is adversarial 0.9999796152114868
selected:  10
selected:  8
selected:  10
selected:  8

Scene 28, Frame 94:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  11
selected:  8
selected:  11
selected:  56

Scene 28, Frame 95:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 2]
Agent 2 is adversarial 1.0
selected:  10
selected:  8
selected:  11
selected:  51

Scene 28, Frame 96:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [0, 1]
Agent 3 is adversarial 0.8620818257331848
Agent 2 is adversarial 0.9999998807907104
Agent 3 is adversarial 0.9999986886978149
selected:  9
selected:  8
selected:  10
selected:  9

Scene 28, Frame 97:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [1, 2]
Agent 3 is adversarial 0.9999264478683472
selected:  10
selected:  8
selected:  10
selected:  74

Scene 28, Frame 98:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 1.0
selected:  10
selected:  8
selected:  8
selected:  51

Scene 28, Frame 99:
all_agent_list: [0, 1, 2]
Perturbation is applied on agent [2, 0]
Agent 2 is adversarial 0.9999992847442627
selected:  11
selected:  7
selected:  9
selected:  52

 Ego Agent:3
robosac VALIDATION: Evaluated on 100 frames
Total Neighbor Agents:5, Sampling Set Size: None, Number of Attackers: 2
Expected guaranteed Consensus Set Size at p=0.99: 0
Succeeded 0, Total 100, Success Rate: 0.0
Sampling STEP MEAN: 0.0, MAX: 0.0, MIN:0.0
Total STEP(including ego only step): MEAN: 0.0, MAX: 0.0, MIN:0.0
FPS: MEAN: inf, MAX: inf, MIN:inf
Sampling STEP:[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.], Ego STEP:[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.], Total STEP:[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0.], FPS:[inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf
 inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf
 inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf
 inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf
 inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf inf
 inf inf inf inf inf inf inf inf inf inf]
Box set matching threshold: 0.3
Local mAP@0.5 from agent 0

robosac.py:1069: RuntimeWarning: divide by zero encountered in true_divide
  fpss = 1000 / (27*steps+17*ego_steps) # forward time: ego only: 17ms; collaborated: 27ms

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1325 | 1102 | 0.783  | 0.775 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.775 |
+-------+------+------+--------+-------+
Local mAP@0.7 from agent 0

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1325 | 1102 | 0.721  | 0.705 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.705 |
+-------+------+------+--------+-------+
Local mAP@0.5 from agent 1

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1436 | 840  | 0.549  | 0.547 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.547 |
+-------+------+------+--------+-------+
Local mAP@0.7 from agent 1

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1436 | 840  | 0.540  | 0.535 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.535 |
+-------+------+------+--------+-------+
Local mAP@0.5 from agent 2

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1428 | 1095 | 0.747  | 0.746 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.746 |
+-------+------+------+--------+-------+
Local mAP@0.7 from agent 2

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1428 | 1095 | 0.683  | 0.672 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.672 |
+-------+------+------+--------+-------+
Local mAP@0.5 from agent 3

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1391 | 4501 | 0.457  | 0.306 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.306 |
+-------+------+------+--------+-------+
Local mAP@0.7 from agent 3

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 1391 | 4501 | 0.340  | 0.251 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.251 |
+-------+------+------+--------+-------+
Local mAP@0.5 from agent 4
det_results is empty. Skipping evaluation.
Local mAP@0.7 from agent 4
det_results is empty. Skipping evaluation.
Local mAP@0.5 from agent 5
det_results is empty. Skipping evaluation.
Local mAP@0.7 from agent 5
det_results is empty. Skipping evaluation.
Average Local mAP@0.5

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 5580 | 7538 | 0.632  | 0.575 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.575 |
+-------+------+------+--------+-------+
Average Local mAP@0.7

+-------+------+------+--------+-------+
| class | gts  | dets | recall | ap    |
+-------+------+------+--------+-------+
| 0     | 5580 | 7538 | 0.570  | 0.519 |
+-------+------+------+--------+-------+
| mAP   |      |      |        | 0.519 |
+-------+------+------+--------+-------+
Quantitative evaluation results of model from /data2/user2/senkang/CP-GuardBench/coperception/ckpt/meanfusion/epoch_49.pth, at epoch 49
agent0 mAP@0.5 is 0.7752214074134827 and mAP@0.7 is 0.704613208770752
agent1 mAP@0.5 is 0.5471526980400085 and mAP@0.7 is 0.5350970029830933
agent2 mAP@0.5 is 0.7457405924797058 and mAP@0.7 is 0.6724774241447449
agent3 mAP@0.5 is 0.305785596370697 and mAP@0.7 is 0.2509792745113373
agent4 mAP@0.5 is 0.0 and mAP@0.7 is 0.0
agent5 mAP@0.5 is 0.0 and mAP@0.7 is 0.0
average local mAP@0.5 is 0.5748468041419983 and average local mAP@0.7 is 0.5192781090736389
